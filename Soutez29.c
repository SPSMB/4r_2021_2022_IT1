#include <stdio.h>
#include <string.h>

void zadanisouteze(){
	const char * zadanisouteze = "Dobry den,\nPrave jste otevreli zadani souteze cislo 29.\nOdpovedi na soutez je jmeno.\nPosilejte ho mailem s predmetem Soutez29 az do 7.10.2021 23:59.\nKazde spravne reseni bude ohodnoceno 2b.\n\n";

	printf("%s", zadanisouteze);
}

void desifruj(const char * sifrovano, char * desifrovano){
	char klic = 0b00110101;
	/* Funkci budete muset naprogramovat Vy. 
	 * Sifrovani probiha tak, ze se kazdy znak retezce nejprve odecte 74 a pak se xoruje s klicem;
	 * Nezapomente na konec desifrovaneho textu pridat ukoncovaci znak pro retezec.
	 */
	
	for (int i = 0; i < strlen(sifrovano); ++i)
	{	
		desifrovano[i] = sifrovano[i] ^ klic;
		desifrovano[i] = desifrovano[i] + 74;
	}
	desifrovano [strlen(sifrovano)] = '\0';
	//strncpy(desifrovano, sifrovano, 500-1);
}

void runstory(){
	const char * osoba_1open = "1)Ahoj, jsem zena.\nPokud chces pokracovat, zadej rok umrti prezidenta Havla.\n";
	const char * osoba_2open = "2)Vyborne, prvni prekazka byla snadna, nyni to bude obtiznejsi.\nDalsi napovedy jsou zasifrovany.\nAbyste je mohli zobrazit, bude nutne nejprve dopsat desifrovaci funkci.\nOtevrete zdrojovy kod programu, naprogramujte funkci desifruj\na pak znovu spustte program.\nKrome napsani teto funkce, neni treba menit v programu nic dalsiho.\n";
	const char * fail = "To nebyla spravna odpoved, program byl prave ukoncen.\n";
	const char * pokyn1 = "Pro zobrazeni dalsi napovedy stiskni klavesu 'x', pro konec programu 'e'.\n";
	
	const char osoba_3cypher[] = {0xDC,0xEA,0x31,0x2E,0x2F,0x22,0x19,0x11,0x10,0xE3,0x15,0x1C,0x2E,0x16,0xE3,0x10,0x1C,0x17,0x22,0x19,0x2A,0x17,0x22,0xE3,0xD9,0xD3,0xD1,0xE3,0x11,0x22,0x1D,0x10,0x05,0x2E,0x11,0x2A,0x11,0x1A,0xD1,0x00};
	const char osoba_4cypher[] = {0xDF,0xEA,0x35,0x1C,0x2E,0x16,0xE3,0x05,0xE3,0xCA,0x1D,0x1C,0x14,0x22,0xD1,0x00};
	const char osoba_5cypher[] = {0xDE,0xEA,0x37,0x2A,0x2F,0x2E,0xE3,0x16,0x2E,0xE3,0x05,0x11,0x22,0x15,0x2A,0xD7,0xE3,0x13,0x1D,0x10,0x1F,0x10,0x05,0x2E,0xE3,0x1D,0x22,0x2F,0x22,0xE3,0x05,0x13,0x2A,0x19,0x22,0x16,0xD1,0x00};
	const char osoba_6cypher[] = {0xD9,0xEA,0x25,0x13,0x2A,0x19,0x22,0x16,0xE3,0x22,0x11,0x28,0x17,0x2A,0x2C,0x14,0x1A,0xD7,0xE3,0x17,0x22,0x1F,0x2A,0x11,0x1C,0x14,0x1A,0xD7,0xE3,0x19,0x2E,0x17,0x1C,0x1C,0x14,0x1A,0xD7,0xE3,0x2A,0x1D,0x1C,0x14,0x1A,0xE3,0x22,0xE3,0x1F,0x22,0x14,0x2E,0xE3,0x1C,0x19,0x10,0x15,0x2A,0xE3,0x1D,0x2E,0x2C,0x2A,0xE3,0x17,0x10,0x1B,0x2A,0x22,0x11,0xD1,0x00};

	const char * sifNapovedy[4] = {osoba_3cypher, osoba_4cypher, osoba_5cypher, osoba_6cypher};
	char desifrovano[500];

	int tmp = 0;
	char tmp2 = '.';

	printf("%s", osoba_1open);
	scanf("%d", &tmp);
	while(getchar()!='\n');
	if(tmp == 2011){
		printf("%s", osoba_2open);
	} else {
		printf("%s\n", fail);
		return;
	}

	int x = 0;
	while(x <= 3){
		printf("%s", pokyn1);
		scanf("%c", &tmp2);
		while(getchar()!='\n');
		if(tmp2 == 'x'){
			desifruj(sifNapovedy[x], desifrovano);
			printf("%s\n", desifrovano);
		} else if(tmp2 == 'e') {
			return;
		}
		tmp2 = '.';
		x++;
	}
	return;
}

int main(void){
	zadanisouteze();
	runstory();
	return 0;
}
